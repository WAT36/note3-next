---
title: "Difyでシステムデザイン面接対策用のAIチャットシステムを作ってみた"
excerpt: "システムデザイン問題対策用のチャットシステムを作成する"
coverImage: ""
date: "2025-08-20T23:06:14.000Z"
updatedAt: "2025-08-20T23:06:14.000Z"
tag: []
author:
  name: Tatsuroh Wakasugi
  picture: "/assets/blog/authors/WAT.jpg"
ogImage:
  url: ""
---

IT 系の技術職において、中途面接でよく聞かれるのがシステムデザインに関する問題である。

これに関しての勉強や対策を行いたかったのだが、練習問題がそんなにあるわけでもない、問題に対して明確な正解がない、回答を評価してくれる人が身近にいないというのが課題であり、なかなか対策が行えずにいた。

であれば、全部 LLM といった AI にやって貰えばいいのではないか？と考え、今回はシステムデザインの問題を考えてもらって出題・それに対するこちらからの回答を受け取って 100 点満点で評価してもらう AI チャットシステムを考えてみた。

作成にあたり、細かいプログラミングが不要で AI アプリケーションを作成できるプラットフォーム「**Dify**」を利用してみたので、そちらについても記載する。

# Dify とは何か？

**Dify[^1]**は、オープンソースの AI アプリ開発プラットフォームです。Backend as Service（BaaS）と LLMOps（Large Language Model Operations）の理念を融合し、開発者だけでなく、プログラミングが得意でない方でも直感的に AI アプリケーションを構築できるツールです。

簡単に言うと、**「ノーコードで ChatGPT のような AI アプリを作れるツール」**と考えてください。

## Dify の主要な特徴

### 1. ノーコード・ローコード開発

プログラミング知識がなくても、ドラッグ&ドロップの直感的な操作で AI アプリケーションを構築できます。

### 2. 豊富な AI モデル対応

以下にあるものを始め、その他多数の LLM モデルを利用できます。

- GPT-4、GPT-3.5（OpenAI）
- Claude 3（Anthropic）
- Gemini（Google）

### 3. 強力な RAG 機能

RAG（Retrieval-Augmented Generation）により、独自のデータベースや文書を活用した AI アプリケーションを作成できます。

### 4. ワークフロー機能

複雑な AI 処理を視覚的にデザインできるワークフロー機能で、多段階の処理や条件分岐なども簡単に実装可能です。

### 5. エージェント機能

自律的に動作する AI エージェントを作成し、複雑なタスクの自動化が可能です。

### 6. 豊富な連携機能

以下をはじめとした諸システムへの連携が可能です。

- API 経由での外部システム連携
- データベース連携
- Webhook 対応
- 各種クラウドサービス連携

## Dify でできることの例

### 1. カスタムチャットボット

- 企業の社内 FAQ 対応
- 商品やサービス説明用のボット
- 学習支援用のチューター

### 2. 文書分析・要約ツール

- PDF 文書の自動要約
- 大量のテキストデータの分析
- 契約書や報告書の内容チェック

### 3. コンテンツ生成ツール

- ブログ記事の自動生成
- SNS 投稿の作成支援
- マーケティングコピーの作成

### 4. 業務自動化ツール

- データ入力の自動化
- レポート生成の自動化
- 顧客対応の効率化

## 料金体系について

### 無料プラン

- 月 200 回の AI 呼び出し
- 基本的な機能の利用
- コミュニティサポート

### 有料プラン

- より多くの AI 呼び出し
- 優先サポート
- 高度な機能の利用
- チーム機能

### セルフホスティング

- 完全無料
- 自社サーバーでの運用
- カスタマイズ自由度が高い

## 始める前に知っておきたいこと

### 1. AI モデルの選択

- 用途に応じて適切なモデルを選ぶ
- コストとパフォーマンスのバランスを考慮
- 日本語対応の度合いを確認

### 2. プロンプトエンジニアリング

- 良いプロンプトがアプリの質を決める
- 具体的で明確な指示を心がける
- 出力形式を指定する

### 3. セキュリティ考慮事項

- 機密情報の取り扱いに注意
- 必要に応じてセルフホスティングを検討
- ユーザー権限の適切な設定

## Dify で AI チャットシステムを作ってみる

それでは今回の主旨である、システムデザイン対策用の AI チャットシステムを作成してみます。

### Step 1: アカウント作成

1. [Dify 公式サイト](https://dify.ai/)にアクセス
2. 「始める」をクリック

![](/assets/posts/difySysDesignChat/difyLogin.png)

3. メールアドレスとパスワードを設定してアカウント作成し、ログインする

![](/assets/posts/difySysDesignChat/difyLogin2.png)

### Step 2: 最初のアプリケーション作成

1. ダッシュボードで「新しいアプリを作成」をクリック
2. アプリケーションのタイプを選択：

- **チャットボット**: 対話型の AI アシスタント
- **テキスト生成**: 入力に基づくテキスト生成
- **エージェント**: 自律的な AI エージェント
- **ワークフロー**: 複雑な処理フロー
- **チャットフロー**:処理フローを組み込んだチャットボット

![](/assets/posts/difySysDesignChat/difyDashboard.png)

今回は「チャットフロー」を選択し、アプリ名を入力して作成するを押下します。

### Step 3: フロー作成

具体的なフローを作成します。

最終的なフローは以下の図のようなものになります。

![](/assets/posts/difySysDesignChat/difyChatFlowAll.png)

最初のフロー作成時には開始、LLM、応答の３ブロックがあると思いますが、そこから処理ブロックを加えていき上記のようにしていきます。

### 変数定義

まずは、事前にこのチャットシステム上で利用する変数を定義しておきます。

問題文を保存しておく変数 problem と、こちらの回答を保存しておく answer という変数を定義しておきます。

画面右上のボタンから会話変数を定義できるので、ここで problem,answer という名前の変数を定義して下さい。（どちらも String で）

この変数は後ほど利用します。

![](/assets/posts/difySysDesignChat/difyVariableNode.png)

### 開始ノード

今回のチャットフローの開始地点となるノードです。

最初からあるものですが、ここは今回は特に変更不要です。

![](/assets/posts/difySysDesignChat/difyStartNode.png)

### 条件分岐ノード

その次に IF/ELSE ブロックを設けさせて、条件分岐のフローを設けます。

ここでは、問題を出題するか、回答を受け取って採点するかのフローに行かせるかに分岐します。

条件には先ほど定義した変数 problem に値が入っているかいないかで分岐します。

以下のように設定して下さい。

変数 problem に値が入っていない場合は問題出題のフローへ、入っている場合は採点のフローへと行きます。

具体的にこの変数 problem に値を入れる動作については後ほど定義します。

![](/assets/posts/difySysDesignChat/difyIfelseNode.png)

### 問題生成ノード

最初に問題出題のフローについてを書きます。

まずは、LLM ノードを使って問題文を生成するノードを作ります。

先ほどの条件分岐で変数が空の場合の後の処理として、以下の図のように設定して下さい。

ポイントとしては、生成した問題文を後続のフローに流すために、出力変数を設定する事です。

（使用するプロンプトは最高の余地あるかもですがこのようにしています）

![](/assets/posts/difySysDesignChat/difyGenerateQuestionNode.png)

### 問題文保存ノード

次にその問題を保存するノードについてを設定します。

前の問題生成ノードから生成した問題文を受け取って、それを変数に格納します。

ノードを以下の図のように設定して下さい。

前ノードで出力変数をオンにしておくと、生成した内容が変数 text に入るので、その内容を problem という変数に格納します。

![](/assets/posts/difySysDesignChat/difySaveQuestionNode.png)

### 問題出題ノード

次にその問題をチャットシステム上で表示・出題するノードについてを設定します。

変数 problem にある問題文を使って、チャット上に表示します。

ノードを以下の図のように設定して下さい。

![](/assets/posts/difySysDesignChat/difyDisplayQuestionNode.png)

これによりチャット上で、システムデザインの問題が出題されるようになります。

問題出題のフローについてはここまでです。

### 回答保存ノード

ここからは、採点のフローについてを書いていきます。

まずは回答を保存するノードについてを設定します。

ユーザーが入力した内容を問題への回答と扱い、それを回答保存用の変数 answer に格納します。

ノードを以下の図のように設定して下さい。

チャットで入力した内容は sys.query という変数に入るので、その内容を answer に保存します。

![](/assets/posts/difySysDesignChat/difySaveAnswerNode.png)

### 採点ノード

次に、実際に採点をするノードについてを書いていきます。

変数 problem と answer から問題文、回答を取り出し、採点を行います。

以下の図のように設定して下さい。

このノードでは、問題文と回答に対して、各観点から１００点満点で採点を行います。

プロンプトは以下のように設定していますが、観点など変えた場合は各自で適宜置き換えて設定して下さい。

その後、採点結果を後続のノードに渡すために、ここも同じく出力変数をオンにしておきます。

![](/assets/posts/difySysDesignChat/difyCritiqueNode.png)

### 採点結果表示ノード

次に、採点結果をチャットに表示するノードについてを書いていきます。

先ほどの採点ノードでの結果を、チャットシステム上に表示します。

以下のように設定して下さい。

ここでも前ノードで出力変数をオンにしておくと、生成した内容が変数 text に入るので、その内容をここで表示させます。

これにより採点結果がチャット上に表示されます。

![](/assets/posts/difySysDesignChat/difyDisplayResultNode.png)

### 変数クリアノード

最後に、両変数をクリアする処理を行います。

先ほどの採点結果表示ノードの後に、以下のようなノードを設定します。

ここでは、変数 problem と answer の中身をクリアする処理を行います。

これにより、次に実行する時は再度問題出題が行われるようになります。

![](/assets/posts/difySysDesignChat/difyClearVariableNode.png)

### Step 4: テストとデバッグ

ここまで実装ができたら、プレビュー機能を使ってテストをしてみましょう。

画面上部にある「プレビュー」ボタンを押して下さい。

![](/assets/posts/difySysDesignChat/difyChatPreview.png)

すると、チャット用のウィンドウが表示されて、入力できるようになります。

何かしら入力して送信すると、システムデザインの問題が出題されるはずです。

![](/assets/posts/difySysDesignChat/difyChatTest.png)

出題されたら、それに対して以下のような回答文を入力して返信してみます。

![](/assets/posts/difySysDesignChat/difyChatAnswer.png)

そうしたら、その回答を問題文と照らし合わせて、採点結果を返してくれるはずです。

![](/assets/posts/difySysDesignChat/difyChatResult.png)

もっとこうしたい、またはこのような観点でみてほしい、などあれば、ノードに設定しているプロンプトなどを適宜調整してみて下さい。

### Step 5: 公開・利用

テストをして満足のいく場合は、「公開する」ボタンから「更新を公開」を押して公開しましょう。

![](/assets/posts/difySysDesignChat/difyChatRelease.png)

すると最新版が公開されます。

公開した後は上記の「アプリを実行」からでも実行できますし、「サイトに埋め込む」から自身の Web ページなどに埋め込んで利用させることも可能です。

また共有用の URL が発行されるので、画面左部からそれを取得して実行することもできます。

![](/assets/posts/difySysDesignChat/difyChatURL.png)

---

というわけで今回は Dify を使って個人的なシステムデザイン対策用 AI チャットシステムを作ってみましたが、別にシステムデザイン対策に限らず、他の用途に対してのシステムも作成可能なので、各自やってみたいことに対してのチャットシステムを応用して作ってもらえたらと思います。

---

[^1]: [Dify（公式ページ）](https://dify.ai/jp)
