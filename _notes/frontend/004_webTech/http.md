---
title: "HTTP・HTTPS"
date: "2023-03-24T21:37:50.000Z"
excerpt: "HTTP・HTTPSについて"
tag: ["Web", "HTML", "CSS"]
updatedAt: "2023-03-24T21:37:50.000Z"
author:
  name: Tatsuroh Wakasugi
  picture: "/assets/blog/authors/WAT.jpg"
---

HTTP、HTTPS プロトコルについてを述べる。

# HTTP プロトコル

HTTP(Hyper Text Transfer Protocol)とは、Web サーバとクライアントの Web ブラウザ間で HTML 文書などのテキストメッセージを受け渡すためのプロトコルである。

HTTP の通信は、クライアントからサーバへの**HTTP リクエスト**と、サーバからクライアントへの**HTTP レスポンス**の 2 つに分けられる。

<img src="/assets/note/frontend/web_other/http1.png">

# HTTPS プロトコル

HTTPS プロトコルは、大まかにいうとセキュリティを確保した通信路上で HTTP 通信を行うプロトコルである。

HTTP 通信を行う前に、セキュリティの確保として、データを暗号化して送受信するプロトコルである SSL プロトコル(または TLS プロトコル)を利用しセッションを確定する。その後に、HTTP セッションの接続を行う。

<img src="/assets/note/frontend/web_other/https.png">

# HTTP のメッセージ構造

HTTP のメッセージは大きく開始行、ヘッダフィールド、CRLF の改行、メッセージボディの 4 つに分けられる。

- 開始行 (リクエストライン/ステータスライン)
- ヘッダフィールド(０行以上、以下から構成)
- General-header
- Request-header
- Response-header
- Entity-header
- 改行(CRLF)
- メッセージボディ

# HTTP の開始行(リクエストメッセージ)

HTTP メッセージの一番最初に書く開始行は以下のような構造になる。

```
メソッド  /任意のパス(+クエリストリング)  HTTP/1.1
```

クエリストリングとはリクエストと同時に送るデータのことで、任意のパスの後に"?"を書き、その後にデータを記入する。

また、メソッドとは以下のいずれかである。

| メソッド名 | 説明                                                                                              |
| :--------- | :------------------------------------------------------------------------------------------------ |
| GET        | 指定した URL(URI)で識別されるリソースを取得                                                       |
| POST       | 指定した URL(URI)で識別されるリソースの子リソースの作成、またはリソースへのデータの追加などを要求 |
| PUT        | 指定した URL(URI)に対してエンティティ(メッセージボディ)に含まれる情報を保存することを要求         |
| HEAD       | GET と同じだがヘッダのみを取得                                                                    |
| OPTIONS    | 指定した URL(URI)がサポートしているメソッドを取得                                                 |
| DELETE     | 指定した URL(URI)で識別されるリソースの削除を要求                                                 |
| TRACE      | 自分宛にリクエストメッセージを要求するループバック試験に使用                                      |

このうちよく使われるのは GET と POST である。

※追記(2024/6/25) HTTP メソッドについては[こちら](../http_method/index.html)に個別でまとめたので、こちらも参考のこと。

# HTTP のレスポンスメッセージ

HTTP のレスポンスメッセージの例は以下の通り。上から開始行、ヘッダフィールド、改行、メッセージボディの順。

```
HTTP/1.1 200 OK
```

```
Date:Wed,  19 Aug 2020 23:48:50 GMT
Server:Apache
Content-type:text/html
```

```
(改行)
```

```
<!DOCTYPE html>
・・・
・・・
```

ここで、レスポンスメッセージの開始行には、レスポンスの状態を示す 3 桁の数字「ステータスコード」が含まれている。

ステータスコードは以下のように分類される。

| ステータスコード | 説明                             |
| :--------------- | :------------------------------- |
| 1xx              | Informational(情報提供のコード)  |
| 2xx              | Success(成功)                    |
| 3xx              | Redirection(転送)                |
| 4xx              | Client Error(クライアントエラー) |
| 5xx              | Server Error(サーバーエラー)     |

# HTTP のヘッダフィールド

ヘッダフィールドには、メッセージの外部情報（メタ情報）を扱うための HTTP ヘッダが含まれる。

HTTP ヘッダとして代表的なものを示す。

| ヘッダ名          | 説明                                                        |
| :---------------- | :---------------------------------------------------------- |
| Accept            | 受入可能なメディア型                                        |
| Authorization     | HTTP の認証情報                                             |
| Cache-Control     | キャッシュの振る舞い                                        |
| Content-Language  | エンティティの自然言語                                      |
| Content-Length    | メッセージボディの長さ                                      |
| Content-Type      | メッセージボディの型                                        |
| Cookie            | ブラウザに保存されたクッキーの値                            |
| Expires           | レスポンスの有効期間                                        |
| If-Modified-Since | 指定時刻以降に更新されているかを確認（条件付き GET で使用） |
| Last-Modified     | リソースの最終更新時刻                                      |
| Referer           | リンクされている元のリソースの URL(URI)                     |
| Set-Cookie        | Web サーバが生成したクッキーの値                            |
| User-Agent        | ユーザーエージェントの名前                                  |

※追記(2024/6/21)

HTTP ヘッダについては[こちら](../httpHeader/index.html)に個別にまとめたので、詳しく見たい場合はこちらも参照。

# HTTP での認証

HTTP では、特定のファイルへのアクセスを制限するために認証することが可能である。

その種類は主に以下の２種類。

## Basic 認証

Basic 認証は、ユーザー名とパスワードをコロンで接続し、Base64 でエンコードして送信することで認証を実施する方式である。

盗聴や改竄が容易にできてしまう。

<img src="/assets/note/frontend/web_other/basic.png" width="75%" height="75%">

## Digest 認証

Digest 認証は、Basic 認証に加えて、盗聴や改竄を防ぐためにユーザー名とパスワードを MDS でハッシュ化して送信し、認証を実施する。

パスワードが暗号化されているので、盗聴できても解読しにくいという利点がある。

<img src="/assets/note/frontend/web_other/digest.png" width="75%" height="75%">

# HTTP cookie (クッキー)

HTTP は、システムの現在の状態を保持しない(ステートレスという)プロトコルであ利、クライアントとサーバ間の状態管理は行えないという点がある。

そこで、Web ブラウザに cookie(クッキー)と呼ばれるデータを保持しておくことで、HTTP での状態管理を実現することができる。

代表的な使用例としては、Web サイト上でのログイン状態の記録、EC サイト上でのカート情報の管理などがある。

クッキーは、サーバからクライアントに返るときの HTTP レスポンスのヘッダ**Set-Cookie**にて指定される。

これにより、Web サーバ上で指定された情報が Web ブラウザに保存される。

その後の Web ページへのアクセス時には、保存していたクッキーを HTTP リクエストと同時に Web サーバに送ることで、状態管理を行う。

また、クッキーは JavaScript を利用して、クライアント側で操作することもできる。
