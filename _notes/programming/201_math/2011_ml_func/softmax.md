---
title: "ソフトマックス関数"
date: "2019-11-07T01:01:30+09:00"
excerpt: "ソフトマックス関数について"
tag: ["Python"]
updatedAt: "2019-11-07T01:01:30+09:00"
author:
  name: Tatsuroh Wakasugi
  picture: "/assets/blog/authors/WAT.jpg"
---

複数の数 $x_{1},x_{2},...,x_{i}$ があり、それらの数の大小関係を保ったままそれぞれを確率を表す数 $y_{1},y_{2},...,y_{i}$ に変換したいとする。

確率を表す変数は 0~1 の範囲内かつ、全ての変数の合計が１になってないといけない。

このような変数を求めたいときに使うのが**ソフトマックス関数**である。求め方は以下の通り。

1: 各 $x_{i}$ の exp の和を求める。

$$
u = \exp(x_{1}) + \exp(x_{2}) + \ldots + \exp(x_{i})
$$

2: 各 $x_{i}$ を 1.の値で割った値を $y_{i}$ とおく。

$$
y_{0} = \frac{\exp(x_{0})}{u}
$$

$$
y_{1} = \frac{\exp(x_{1})}{u}
$$

$$
\vdots
$$

$$
y_{i} = \frac{\exp(x_{i})}{u}
$$

実装例を以下に示す。

```python
>>> import numpy as np
>>>
>>> #ソフトマックス関数
>>> def softmax(*x):
...     u=0
...     for i in range(len(x)):
...             u += np.exp(x[i])
...     y=[]
...     for i in range(len(x)):
...             y.append(np.exp(x[i])/u)
...     return y
...
>>>
>>> #x0=2,x1=1,x2=-2としてソフトマックス関数適用
>>> y = softmax(2,1,-1)
>>>
>>> #計算後のyの値
>>> print(y)
[0.7053845126982412, 0.2594964603424191, 0.03511902695933972]
>>>
>>> #yの合計値は１になる
>>> sum(y)
1.0
>>>
```
